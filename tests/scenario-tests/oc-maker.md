# OC 创建器 (OC Maker) - 场景测试

## 测试目标

验证 OC 角色的创建、编辑、生成和管理流程，包括"灵魂显现"（快速生成）和"神匠之作"（手动编辑）两种模式。

## 前置条件

- [ ] 服务已启动 (`pnpm dev`)
- [ ] 已登录测试账号
- [ ] 测试账号有足够积分（快速生成消耗约 10 MC）
- [ ] 确保账号未达到 OC 创建数量上限

## 测试场景

---

### 场景 1: 灵魂显现 (快速生成)

**目标**: 验证通过简短描述快速生成一个完整 OC 的流程。

#### 测试步骤
1. [ ] 打开 `/oc-maker` 页面
2. [ ] 在描述框输入: `A cool dragon girl with silver hair and blue horns, wearing gothic armor`
3. [ ] 选择性别: `Female`
4. [ ] 选择艺术风格: `Cyberpunk`
5. [ ] 选择种族: `Dragon`
6. [ ] 点击"生成"按钮

#### 预期结果
- [ ] 显示生成进度弹窗，包含多个阶段：
    - 解析描述 (Parsing description)
    - 创建数据 (Creating character data)
    - 生成立绘 (Generating character portrait)
    - 设置头像 (Setting up avatar)
- [ ] 积分正确扣减
- [ ] 生成成功后自动跳转到角色详情页 `/characters/[uuid]`
- [ ] 角色基本信息（姓名、性别、种族、简介）自动填充
- [ ] 角色头像和封面图已生成并显示

#### 边界测试
- [ ] 描述为空时无法提交
- [ ] 积分不足时点击生成，提示积分不足并引导充值
- [ ] 连续点击生成，应有防抖或加载状态防止重复提交

---

### 场景 2: 神匠之作 (手动编辑/创建)

**目标**: 验证从零开始手动创建和编辑 OC 细节的流程。

#### 测试步骤
1. [ ] 在 `/oc-maker` 页面点击"从零开始创建" (Start from scratch)
2. [ ] 验证跳转到新建角色的编辑模式 `/characters/[uuid]?mode=create`
3. [ ] 在"基本信息"中填写：
    - 姓名
    - 角色职责
    - 年龄
    - 简短介绍
4. [ ] 进入"外貌设定" (Appearance) 填写细节
5. [ ] 进入"性格设定" (Personality) 选择或输入标签
6. [ ] 进入"背景设定" (Background) 填写背景故事
7. [ ] 点击"保存"

#### 预期结果
- [ ] 所有手动填写的模块数据正确保存
- [ ] 页面显示保存成功的提示
- [ ] 角色详情页显示更新后的信息

---

### 场景 3: 角色模块化编辑

**目标**: 验证 OC 的各个模块（外貌、性格、背景、艺术）是否可以独立编辑。

#### 测试步骤
1. [ ] 在角色详情页点击"编辑"按钮
2. [ ] 切换到不同标签页：
    - [ ] 外貌 (Appearance)
    - [ ] 性格 (Personality)
    - [ ] 背景 (Background)
    - [ ] 艺术设定 (Art Settings)
3. [ ] 修改外貌中的"发色"
4. [ ] 在性格中添加新标签
5. [ ] 在艺术设定中修改"画风描述"
6. [ ] 点击保存

#### 预期结果
- [ ] 各个模块切换流畅，数据不丢失
- [ ] 保存后数据在数据库中正确更新
- [ ] UI 上显示修改后的内容

---

### 场景 4: 角色头像与封面管理

**目标**: 验证为角色生成或上传头像/封面的功能。

#### 测试步骤
1. [ ] 在角色编辑页面，找到头像区域
2. [ ] 点击"AI 生成头像"按钮
3. [ ] 验证头像生成并自动更新
4. [ ] 找到封面图区域，点击上传新图片
5. [ ] 保存修改

#### 预期结果
- [ ] AI 生成头像消耗相应积分
- [ ] 生成的头像正确显示在角色卡片上
- [ ] 上传的封面图正确显示并裁剪适配

---

### 场景 5: 角色可见性与权限

**目标**: 验证角色的公开/私密设置。

#### 测试步骤
1. [ ] 创建一个新角色
2. [ ] 在编辑模式下将"可见性"设置为"私密" (Private)
3. [ ] 记录该角色 URL，尝试用另一个未登录账号访问
4. [ ] 回到编辑模式将"可见性"设置为"公开" (Public)
5. [ ] 再次尝试用其他账号访问

#### 预期结果
- [ ] 私密角色：非所有者访问显示"拒绝访问"或 404
- [ ] 公开角色：所有人均可访问，显示作者信息和交互按钮（点赞、收藏）

---

### 场景 6: 角色删除与恢复

**目标**: 验证删除 OC 的流程。

#### 测试步骤
1. [ ] 进入 `/my-characters` (或用户中心角色列表)
2. [ ] 找到要删除的角色，点击删除图标/按钮
3. [ ] 在确认弹窗中确认删除
4. [ ] 刷新页面验证角色是否消失

#### 预期结果
- [ ] 删除前有二次确认弹窗
- [ ] 删除后该角色不再出现在列表中
- [ ] 直接访问该角色 URL 应返回 404

---

### 场景 7: Remix (二创) 功能

**目标**: 验证基于已有角色进行二次创作。

#### 测试步骤
1. [ ] 访问一个他人的公开角色页面
2. [ ] 点击 "Remix" 按钮
3. [ ] 验证跳转到编辑页面，且带有了原始角色的基础信息
4. [ ] 修改部分设定，点击保存

#### 预期结果
- [ ] 新创建的角色 `remixed_from_uuid` 字段应指向原角色
- [ ] 角色详情页应显示"来自 [原作者] 的创作"之类的来源信息

---

## 相关文档

- API 文档: `docs/2-implementation/api/oc-maker.md`
- 数据模型: `docs/1-specs/data-models.md`
- 功能说明: `src/components/oc-maker/README.md` (如有)

## 变更历史

- 2026-01-27 补齐 OC Maker 核心场景测试
