# AI 动漫生成器 - 场景测试

## 测试目标

验证 AI 动漫生成器的各种使用场景，包括文字生成、引用图片、OC 角色、不同风格和比例等。

## 前置条件

- [ ] 服务已启动 (`pnpm dev`)
- [ ] 已登录测试账号
- [ ] 测试账号有足够积分（建议 ≥100 MC）
- [ ] 已创建至少 1 个 OC 角色（用于测试 OC 功能）
- [ ] 准备测试图片（用于测试引用图片功能）

## 测试场景

---

### 场景 1: 基础文字生成

**目标**: 验证最基本的文字生成功能

#### 测试步骤
1. [ ] 打开 `/ai-anime-generator` 页面
2. [ ] 在 Prompt 输入框输入: `a cute anime girl with blue hair and green eyes`
3. [ ] 选择风格: `Anime`
4. [ ] 选择比例: `1:1`
5. [ ] 选择模型: `nano-banana-1.0`
6. [ ] 点击"生成"按钮

#### 预期结果
- [ ] 显示生成进度（进度条或加载动画）
- [ ] 积分正确扣减（根据定价模型）
- [ ] 生成成功后显示图片
- [ ] 生成记录的 `status` 默认为 `archived`
- [ ] 图片比例正确（1:1）
- [ ] 可以点击图片查看大图
- [ ] 可以下载图片
- [ ] 可以分享到社区
- [ ] 可以重新生成（Remix）

#### 边界测试
- [ ] Prompt 为空时点击生成，显示错误提示
- [ ] 积分不足时点击生成，显示错误提示并引导充值
- [ ] 超长 Prompt (500+ 字符) 可以正常生成

---

### 场景 2: 使用 Prompt 优化功能

**目标**: 验证 Prompt 优化功能是否正常工作

#### 测试步骤
1. [ ] 在 Prompt 输入框输入简短文字: `cute girl`
2. [ ] 点击"优化 Prompt"按钮或图标
3. [ ] 等待优化结果

#### 预期结果
- [ ] 显示优化中的加载状态
- [ ] 返回优化后的 Prompt（更详细、更专业）
- [ ] 优化后的 Prompt 自动填充到输入框
- [ ] 可以选择是否使用优化后的 Prompt

#### 边界测试
- [ ] Prompt 为空时优化，显示错误提示
- [ ] 已经很详细的 Prompt 优化，仍能返回结果

---

### 场景 3: 使用引用图片生成

**目标**: 验证使用引用图片（Reference Image）生成功能

#### 测试步骤
1. [ ] 上传 1 张引用图片
2. [ ] 输入 Prompt: `same style and character`
3. [ ] 选择风格: `Anime`
4. [ ] 选择比例: `1:1`
5. [ ] 点击"生成"按钮

#### 预期结果
- [ ] 图片上传成功，显示缩略图
- [ ] 可以删除已上传的图片
- [ ] 生成的图片风格与引用图片相似
- [ ] 积分扣减正确（引用图片可能有额外费用）

#### 多图片测试
- [ ] 上传 2 张引用图片，验证都能显示
- [ ] 上传 3 张引用图片，验证都能显示
- [ ] 删除其中一张，验证其他图片不受影响

#### 边界测试
- [ ] 上传超大图片 (>10MB)，显示错误提示
- [ ] 上传非图片文件，显示错误提示
- [ ] 上传错误格式图片 (.bmp, .tiff)，验证处理

---

### 场景 4: 使用 OC 角色生成

**目标**: 验证使用 OC 角色进行生成功能

#### 测试步骤
1. [ ] 点击"选择角色"按钮
2. [ ] 从列表中选择一个 OC 角色
3. [ ] 输入 Prompt: `standing in a beautiful garden`
4. [ ] 选择风格: `Anime`
5. [ ] 选择比例: `3:4`
6. [ ] 点击"生成"按钮

#### 预期结果
- [ ] OC 角色选择器显示用户的所有 OC
- [ ] 选中的 OC 显示在生成器界面
- [ ] 生成的图片包含选中的 OC 角色特征
- [ ] 可以取消选中的 OC
- [ ] 可以切换不同的 OC

#### 边界测试
- [ ] 没有创建 OC 时，显示引导创建 OC 的提示
- [ ] 选中 OC 后再上传引用图片，两者可以同时使用

---

### 场景 5: 不同风格测试

**目标**: 验证不同风格生成效果

#### 测试步骤
对以下每种风格进行测试:
- [ ] `Anime` - 日式动漫风格
- [ ] `Chibi` - Q版风格
- [ ] `Cyberpunk` - 赛博朋克风格
- [ ] `Watercolor` - 水彩风格
- [ ] `Pixel Art` - 像素风格
- [ ] `Ghibli` - 吉卜力风格
- [ ] `American Comics` - 美式漫画风格
- [ ] `Cinematic Anime` - 电影感动漫风格

每种风格使用相同 Prompt: `a young hero standing on a cliff`

#### 预期结果
- [ ] 每种风格生成的图片有明显的风格差异
- [ ] 风格选择器 UI 正常显示
- [ ] 可以切换风格

---

### 场景 6: 不同比例测试

**目标**: 验证不同图片比例生成

#### 测试步骤
对以下每种比例进行测试:
- [ ] `1:1` (Square)
- [ ] `3:4` (Portrait)
- [ ] `4:3` (Landscape)
- [ ] `9:16` (Vertical)
- [ ] `16:9` (Horizontal)
- [ ] `2:3`
- [ ] `3:2`
- [ ] `4:5`
- [ ] `5:4`

每种比例使用相同 Prompt 和风格

#### 预期结果
- [ ] 每种比例生成的图片尺寸正确
- [ ] 比例选择器 UI 正常显示（图标或文字）
- [ ] 可以切换比例
- [ ] 不同比例的积分消耗可能不同

---

### 场景 7: 使用快捷 Prompt 标签

**目标**: 验证快捷 Prompt 标签功能

#### 测试步骤
1. [ ] 找到 Prompt 输入框下方的标签区域
2. [ ] 点击不同类别的标签（如动作、场景、服装等）
3. [ ] 选择多个标签
4. [ ] 验证 Prompt 输入框内容

#### 预期结果
- [ ] 标签按类别分组显示
- [ ] 点击标签后，标签内容添加到 Prompt
- [ ] 可以选择多个标签
- [ ] 可以取消选中的标签
- [ ] Prompt 格式正确（标签之间用逗号分隔）

#### 测试类别
- [ ] 动作 (Actions)
- [ ] 场景 (Scenes)
- [ ] 服装 (Outfits)
- [ ] 相机运动 (Camera Motions) - 如果有

---

### 场景 8: 生成历史查看

**目标**: 验证生成历史功能

#### 测试步骤
1. [ ] 完成至少 3 次图片生成
2. [ ] 查看页面上的生成历史区域
3. [ ] 点击历史记录中的图片

#### 预期结果
- [ ] 历史记录按时间倒序显示
- [ ] 显示生成的图片缩略图
- [ ] 显示生成参数（Prompt、风格、比例）
- [ ] 点击可以查看大图
- [ ] 可以重新使用历史记录的参数（Remix）
- [ ] 分页加载（如果历史很多）

---

### 场景 9: 生成结果操作

**目标**: 验证对生成结果的各种操作

#### 测试步骤
生成 1 张图片后，测试以下操作:

1. [ ] 点击图片查看大图
2. [ ] 点击"下载"按钮
3. [ ] 点击"分享到社区"按钮
4. [ ] 点击"重新生成" (Remix) 按钮
5. [ ] 点击"删除"按钮（如果有）

#### 预期结果
- [ ] 查看大图: 打开模态窗口，显示完整图片
- [ ] 下载: 下载图片到本地，文件名合理
- [ ] 分享到社区:
  - [ ] 可以选择可见性（公开/私密）
  - [ ] 分享成功后显示提示
  - [ ] 可以在社区页面看到分享的作品
- [ ] Remix:
  - [ ] 自动填充原始参数
  - [ ] 可以修改参数
  - [ ] 生成新图片
- [ ] 删除: 删除后从历史中移除

---

### 场景 10: 并发生成测试

**目标**: 验证同时创建多个生成任务

#### 测试步骤
1. [ ] 快速连续点击"生成"按钮 3 次
2. [ ] 观察生成任务状态

#### 预期结果
- [ ] 每次点击都创建新任务（或限制同时生成数量）
- [ ] 每个任务独立显示进度
- [ ] 任务完成后正确显示结果
- [ ] 积分扣减正确（每次扣减对应费用）

#### 边界测试
- [ ] 积分不足时，后续任务失败并提示
- [ ] 任务失败时，正确显示错误信息

---

### 场景 11: 错误处理测试

**目标**: 验证各种错误情况的处理

#### 测试步骤

**11.1 网络错误**
1. [ ] 断开网络
2. [ ] 点击"生成"按钮
3. [ ] 恢复网络

**预期结果**:
- [ ] 显示网络错误提示
- [ ] 可以重试
- [ ] 不扣减积分

**11.2 生成超时**
1. [ ] 等待生成任务超过 5 分钟（如果有超时机制）

**预期结果**:
- [ ] 显示超时错误
- [ ] 积分退款（如果适用）
- [ ] 可以重试

**11.3 生成失败**
1. [ ] 使用可能导致失败的 Prompt (违规内容)
2. [ ] 点击"生成"按钮

**预期结果**:
- [ ] 显示失败原因
- [ ] 积分退款
- [ ] 引导用户修改 Prompt

---

### 场景 12: 响应式设计测试

**目标**: 验证移动端和不同屏幕尺寸的体验

#### 测试步骤
在以下设备/屏幕尺寸测试:
- [ ] 桌面端 (1920×1080)
- [ ] 平板端 (768×1024)
- [ ] 移动端 (375×667)

#### 预期结果
- [ ] 所有元素正常显示
- [ ] 按钮和输入框大小适配
- [ ] 图片画廊正确布局
- [ ] 触摸操作流畅（移动端）
- [ ] 没有横向滚动

---

## 测试结果记录

### 测试环境
- 测试日期: ___________
- 测试人员: ___________
- 浏览器: ___________
- 系统: ___________

### 结果摘要
- 通过场景: ___ / 12
- 发现问题: ___ 个

### 发现的问题
1.
2.
3.

### 备注

---

## 相关文档

- API 文档: `docs/2-implementation/api/anime-generation.md`
- 功能文档: `docs/2-implementation/features/feature-ai-anime-generator.md`
- 前端文档: `docs/2-implementation/frontend/page-ai-anime-generator.md`
- 定价模型: `docs/1-specs/pricing-model.md`

## 变更历史

- 2025-11-12 初始版本
