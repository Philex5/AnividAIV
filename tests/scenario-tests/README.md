# 场景测试说明

## 概述

场景测试用于验证核心业务流程的完整性和用户体验，通过模拟真实用户操作来发现问题。

## 测试方法

采用**手动测试 + 检查清单**的方式：

1. 按照场景文档的步骤操作
2. 勾选完成的测试项
3. 记录发现的问题
4. 验证各种参数组合和边界情况

## 场景列表

### 1. AI 动漫生成器 (ai-anime-generator.md)

测试动漫图片生成的各种场景：
- 基础文字生成
- 使用引用图片生成
- 使用 OC 角色生成
- 多引用图片组合
- 不同风格和比例
- Prompt 优化功能

### 2. AI 视频生成器 (ai-video-generator.md)

测试视频生成的各种场景：
- 文字生成视频
- 图片生成视频
- 不同模型和时长
- 不同比例和参数
- 报价和积分消耗

### 3. OC Maker (oc-maker.md)

测试 OC 角色创建流程：
- 创建新 OC
- 编辑 OC 信息
- 生成 OC 头像和立绘
- 删除 OC
- 使用限额检查

### 4. 聊天系统 (chat.md)

测试与角色对话功能：
- 创建聊天会话
- 发送消息和接收回复
- 多轮对话
- 会话历史
- 不同角色对话

### 5. 社区互动 (community.md)

测试社区功能：
- 浏览作品
- 筛选和排序
- 点赞和收藏
- 作品详情查看
- 修改作品可见性

### 6. 支付流程 (payments.md)

测试支付和订阅：
- 购买积分
- 订阅会员
- 取消订阅
- 退款流程
- 支付回调

## 使用方法

### 1. 选择测试场景

根据开发进度或测试需求，选择要测试的场景文档。

### 2. 准备测试环境

- 启动开发服务器: `pnpm dev`
- 准备测试账号（普通用户、VIP 用户）
- 准备测试数据（如 OC 角色、生成历史等）

### 3. 执行测试

1. 打开场景文档（如 `ai-anime-generator.md`）
2. 按照文档中的步骤操作
3. 验证每一步的预期结果
4. 勾选完成的测试项 `[ ]` → `[x]`
5. 记录发现的问题

### 4. 记录结果

将测试结果记录到 `test-results/YYYYMMDD-scenario-test.md`

**记录内容**：
- 测试的场景
- 通过的测试项数量
- 发现的问题（截图、错误信息、复现步骤）
- 测试环境信息

## 测试覆盖策略

### 正常路径测试

验证功能在正常使用情况下是否工作正常。

**示例**: AI 动漫生成器 - 基础文字生成
- 输入 prompt
- 选择风格
- 选择比例
- 点击生成
- 等待结果
- 验证图片显示

### 边界情况测试

测试极端参数和边界值。

**示例**: AI 动漫生成器 - Prompt 长度
- 空 prompt
- 超长 prompt (1000+ 字符)
- 特殊字符 prompt

### 错误处理测试

测试错误情况的处理。

**示例**: 积分不足
- 积分为 0 时尝试生成
- 验证错误提示
- 验证引导购买积分

### 参数组合测试

测试不同参数的组合。

**示例**: AI 动漫生成器参数组合
- 不同风格 × 不同比例
- 使用/不使用引用图片
- 使用/不使用 OC 角色
- Prompt 优化开/关

### 并发测试

测试同时进行多个操作。

**示例**: 多个生成任务
- 同时创建多个生成任务
- 验证任务状态独立更新
- 验证积分正确扣减

## 测试检查清单

每个场景文档都包含完整的测试检查清单，格式如下：

```markdown
## 测试场景 1: 基础文字生成

### 步骤
1. [ ] 打开 AI 动漫生成器页面
2. [ ] 输入 prompt: "a cute anime girl"
3. [ ] 选择风格: Anime
4. [ ] 选择比例: 1:1
5. [ ] 点击"生成"按钮

### 预期结果
- [ ] 显示生成进度
- [ ] 积分正确扣减
- [ ] 生成成功后显示图片
- [ ] 可以下载图片
- [ ] 可以分享到社区

### 边界情况
- [ ] Prompt 为空时显示错误提示
- [ ] 积分不足时显示错误提示
- [ ] 网络错误时显示错误提示
```

## 常见问题

### Q: 如何处理测试数据？

A: 每次测试前可以：
1. 使用专门的测试账号
2. 测试后清理生成的数据
3. 或者保留测试数据供后续测试使用

### Q: 如何验证积分扣减是否正确？

A:
1. 记录操作前的积分余额
2. 执行操作
3. 验证操作后的积分变化是否符合定价模型

### Q: 发现 bug 如何记录？

A: 记录以下信息：
- Bug 标题
- 复现步骤
- 预期结果
- 实际结果
- 截图或错误信息
- 测试环境（浏览器、系统等）

### Q: 如何测试支付流程？

A: 使用 Stripe/Creem 的测试模式：
- Stripe 测试卡号: `4242 4242 4242 4242`
- 过期日期: 任意未来日期
- CVC: 任意 3 位数字

## 测试优先级

### P0 - 必测场景

每次发布前必须测试：
- 支付流程（购买积分、订阅）
- AI 动漫生成器基础功能
- AI 视频生成器基础功能
- 用户认证和授权

### P1 - 重点场景

功能变更时必须测试：
- OC Maker 完整流程
- 聊天系统
- 社区互动

### P2 - 常规场景

定期回归测试：
- 各种参数组合
- 边界情况
- 并发操作

## 参考文档

- **功能文档**: `docs/2-implementation/features/`
- **API 文档**: `docs/2-implementation/api/`
- **数据模型**: `docs/1-specs/data-models.md`
- **定价模型**: `docs/1-specs/pricing-model.md`

## 变更历史

- 2025-11-12 初始版本，重构为简化的场景测试方案
